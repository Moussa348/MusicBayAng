<app-nav></app-nav>
<div class="container" @fade>
  <div class="p-5"></div>
  <div class="p-5"></div>
  <mat-divider class="text-light border border-3"></mat-divider>
  <div class="p-4"></div>
  <div
    class="
      row
      d-flex
      justify-content-center
      text-uppercase
      font-weight-bold
      text-light text-center
    "
  >
    <h1 style="font-family: 'Times New Roman', Times, serif">
      Conversation<i class="fas fa-comments"></i>
    </h1>
  </div>
  <div class="p-4"></div>
  <mat-divider class="text-light border border-3"></mat-divider>
  <div class="p-5"></div>
</div>

<div class="container-fluid">
  <div class="row d-flex justify-content-center">
    <div class="col-2"></div>

    <div
      class="col-8 border shadow-lg rounded"
      style="height: 300px; height: 900px"
    >
      <div class="row">
        <div
          class="col-4 border d-flex justify-content-start"
          style="
            height: 900px;
            overflow-x: auto;
            overflow-y: auto;
            width: 320px;
          "
        >
          <div class="flex-row text-light">
            <mat-card
              *ngFor="let lastSentMessage of lastSentMessages; let i = index"
              (click)="
                getMessagesFromConversation(lastSentMessage.conversationId)
              "
            >
              <div
                class="d-flex align-items-center rounded pl-2 btn text-light"
              >
                <div class="flex-shrink-0">
                  <img
                    [src]="[
                      'http://localhost:4444/user/getPicture/' +
                        lastSentMessage.sendBy
                    ]"
                    alt="vaccinCovid"
                    class="
                      rounded-pill
                      border border-2
                      img-responsive
                      h-100
                      ml-1
                    "
                  />
                </div>

                <div class="flex-grow-1 ms-4 text-start">
                  <div class="flex-row">
                    <small class="text-capitalize"
                      >{{
                        isConversationGroup(i)
                          ? lastSentMessage.conversationName
                          : lastSentMessage.sendBy
                      }}<i
                        class="fas fa-users"
                        *ngIf="isConversationGroup(i)"
                      ></i>
                      <i
                        class="fas fa-user"
                        *ngIf="!isConversationGroup(i)"
                      ></i>
                    </small>
                  </div>
                  <div class="flex-row">
                    <small>{{ lastSentMessage.content }}</small>
                  </div>
                  <div class="flex-row">
                    <small>{{ lastSentMessage.date | date: "medium" }}</small>
                  </div>
                  <div class="flex-row">
                    <div class="p-2"></div>
                  </div>
                  <div class="flex-row">
                    <mat-divider class="border border-1"></mat-divider>
                  </div>
                </div>
              </div>
            </mat-card>
          </div>
        </div>

        <div class="col-8">
          <div class="flex-row d-flex justify-content-end mt-3">
            <i class="fas fa-users-cog text-light btn fa-2x" (click)="openListUserConvo()"></i>
            <i class="fas fa-user-plus text-light btn fa-2x"></i>
          </div>
          <div class="flex-row">
            <div class="d-flex justify-content-center align-self-center">
              <h3 class="text-capitalize text-light">
                {{ conversation.name }}
              </h3>
            </div>
          </div>

          <div class="row d-flex justify-content-center mt-5">
            <mat-divider class="text-light border border-2"></mat-divider>
          </div>
        </div>
      </div>
    </div>

    <div class="col-2"></div>
  </div>
</div>

<div class="flex-row">
  <div class="p-5"></div>
  <div class="p-4"></div>
</div>
<app-footer class="position-sticky"></app-footer>
